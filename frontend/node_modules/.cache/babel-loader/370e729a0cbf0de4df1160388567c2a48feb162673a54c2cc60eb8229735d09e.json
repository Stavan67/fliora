{"ast":null,"code":"import _objectSpread from\"E:/fliora/fliora/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from\"react\";import{Link,useNavigate}from'react-router-dom';import authService from'../../services/authService';import'../../styles/LoginPage.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const LoginPage=_ref=>{let{onLogin}=_ref;const[formData,setFormData]=useState({usernameOrEmail:'',password:''});const[errors,setErrors]=useState({});const[loading,setLoading]=useState(false);const[showEmailVerification,setShowEmailVerification]=useState(false);const[userEmail,setUserEmail]=useState('');const navigate=useNavigate();const handleChange=e=>{const{name,value}=e.target;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:value}));if(errors[name]){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:''}));}};const validateForm=()=>{const newErrors={};if(!formData.usernameOrEmail.trim()){newErrors.usernameOrEmail='Username or email is required';}if(!formData.password.trim()){newErrors.password='Password is required';}return newErrors;};const handleSubmit=async e=>{e.preventDefault();const validationErrors=validateForm();if(Object.keys(validationErrors).length>0){setErrors(validationErrors);return;}setLoading(true);setErrors({});try{const response=await authService.login(formData);if(response.success){onLogin(response.user);navigate('/dashboard');}}catch(error){console.error('Login error:',error);if(error.requiresEmailVerification){setUserEmail(formData.usernameOrEmail);}else{setErrors({general:error.message||'Login failed. Please try again.'});}}finally{setLoading(false);}};if(showEmailVerification){return/*#__PURE__*/_jsx(\"div\",{className:\"auth-page\",children:/*#__PURE__*/_jsx(\"div\",{className:\"form-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"verification-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"verification-icon\",children:\"\\uD83D\\uDCE7\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"verification-title\",children:\"Email Verification Required\"}),/*#__PURE__*/_jsx(\"p\",{className:\"verification-description\",children:\"Please verify your email address before logging in. Check your inbox for a verification link.\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{className:\"resend-btn\",onClick:async()=>{try{await authService.resendVerificationEmail(userEmail);alert('Verification email send!');}catch(error){alert('Failed to send email: '+error.message);}},children:\"Resend Email\"}),/*#__PURE__*/_jsx(\"button\",{className:\"back-btn\",onClick:()=>setShowEmailVerification(false),children:\"Back to Login\"})]})]})})});}return/*#__PURE__*/_jsx(\"div\",{className:\"auth-page\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"form-container\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"form-title\",children:\"Welcome Back\"}),/*#__PURE__*/_jsx(\"p\",{className:\"login-subtitle\",children:\"Sign in to your Fliora account\"}),errors.general&&/*#__PURE__*/_jsx(\"div\",{className:\"alert error\",children:errors.general}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"usernameOrEmail\",className:\"form-label\",children:\"Username or Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"usernameOrEmail\",name:\"usernameOrEmail\",value:formData.usernameOrEmail,onChange:handleChange,className:\"form-input \".concat(errors.usernameOrEmail?'error':''),placeholder:\"Enter your username or email\"}),errors.usernameOrEmail&&/*#__PURE__*/_jsx(\"span\",{className:\"error-message\",children:errors.usernameOrEmail})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",className:\"form-label\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",name:\"password\",value:formData.password,onChange:handleChange,className:\"form-input \".concat(errors.password?'error':''),placeholder:\"Enter your password\"}),errors.password&&/*#__PURE__*/_jsx(\"span\",{className:\"error-message\",children:errors.password})]}),/*#__PURE__*/_jsxs(\"button\",{type:\"submit\",className:\"submit-btn\",disabled:loading,children:[loading&&/*#__PURE__*/_jsx(\"span\",{className:\"loading-spinner\"}),loading?'Signing In...':'Sign In']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-footer\",children:[\"Don't have an account? \",/*#__PURE__*/_jsx(Link,{to:\"/register\",className:\"form-link\",children:\"Sign up here\"})]})]})});};export default LoginPage;","map":{"version":3,"names":["React","useState","Link","useNavigate","authService","jsx","_jsx","jsxs","_jsxs","LoginPage","_ref","onLogin","formData","setFormData","usernameOrEmail","password","errors","setErrors","loading","setLoading","showEmailVerification","setShowEmailVerification","userEmail","setUserEmail","navigate","handleChange","e","name","value","target","prev","_objectSpread","validateForm","newErrors","trim","handleSubmit","preventDefault","validationErrors","Object","keys","length","response","login","success","user","error","console","requiresEmailVerification","general","message","className","children","onClick","resendVerificationEmail","alert","onSubmit","htmlFor","type","id","onChange","concat","placeholder","disabled","to"],"sources":["E:/fliora/fliora/frontend/src/components/auth/LoginPage.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport authService from '../../services/authService';\r\nimport '../../styles/LoginPage.css'\r\n\r\n\r\nconst LoginPage = ({ onLogin }) => {\r\n    const [formData, setFormData] = useState({\r\n        usernameOrEmail: '',\r\n        password:''\r\n    });\r\n    const [errors, setErrors] = useState({});\r\n    const [loading, setLoading] = useState(false);\r\n    const [showEmailVerification, setShowEmailVerification] = useState(false);\r\n    const [userEmail, setUserEmail] = useState('');\r\n\r\n    const navigate = useNavigate();\r\n\r\n    const handleChange = (e) => {\r\n        const {name, value} = e.target;\r\n        setFormData(prev => ({\r\n            ...prev,\r\n            [name]: value\r\n        }));\r\n\r\n        if (errors[name]) {\r\n            setErrors(prev => ({\r\n                ...prev,\r\n            [name]: ''\r\n            }));\r\n        }\r\n    };\r\n\r\n    const validateForm = () => {\r\n        const newErrors = {};\r\n\r\n        if(!formData.usernameOrEmail.trim()) {\r\n            newErrors.usernameOrEmail = 'Username or email is required';\r\n        }\r\n\r\n        if(!formData.password.trim()) {\r\n            newErrors.password = 'Password is required';\r\n        }\r\n\r\n        return newErrors;\r\n    }\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n\r\n        const validationErrors = validateForm();\r\n        if(Object.keys(validationErrors).length > 0) {\r\n            setErrors(validationErrors);\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n        setErrors({});\r\n\r\n        try {\r\n            const response = await authService.login(formData);\r\n\r\n            if(response.success) {\r\n                onLogin(response.user);\r\n                navigate('/dashboard');\r\n            }\r\n        } catch (error) {\r\n            console.error('Login error:', error);\r\n\r\n            if(error.requiresEmailVerification) {\r\n                setUserEmail(formData.usernameOrEmail);\r\n            } else {\r\n                setErrors({\r\n                    general: error.message || 'Login failed. Please try again.'\r\n                });\r\n            }\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    if(showEmailVerification) {\r\n        return (\r\n            <div className=\"auth-page\">\r\n                <div className=\"form-container\">\r\n                    <div className=\"verification-container\">\r\n                        <div className=\"verification-icon\">ðŸ“§</div>\r\n                        <h2 className=\"verification-title\">Email Verification Required</h2>\r\n                        <p className=\"verification-description\">\r\n                            Please verify your email address before logging in. Check your inbox for a verification link.\r\n                        </p>\r\n                        <div>\r\n                            <button\r\n                                className=\"resend-btn\"\r\n                                onClick={async () => {\r\n                                    try {\r\n                                        await authService.resendVerificationEmail(userEmail);\r\n                                        alert('Verification email send!');\r\n                                } catch (error) {\r\n                                        alert('Failed to send email: ' + error.message);\r\n                                    }\r\n                                }}\r\n                            >\r\n                                Resend Email\r\n                            </button>\r\n                            <button\r\n                                className=\"back-btn\"\r\n                                onClick={() => setShowEmailVerification(false)}\r\n                            >\r\n                                Back to Login\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"auth-page\">\r\n            <div className=\"form-container\">\r\n                <h2 className=\"form-title\">Welcome Back</h2>\r\n                <p className=\"login-subtitle\">Sign in to your Fliora account</p>\r\n\r\n                {errors.general && (\r\n                    <div className=\"alert error\">\r\n                        {errors.general}\r\n                    </div>\r\n                )}\r\n\r\n                <form onSubmit={handleSubmit}>\r\n                    <div className=\"form-group\">\r\n                        <label htmlFor=\"usernameOrEmail\" className=\"form-label\">\r\n                            Username or Email\r\n                        </label>\r\n                        <input\r\n                            type=\"text\"\r\n                            id=\"usernameOrEmail\"\r\n                            name=\"usernameOrEmail\"\r\n                            value={formData.usernameOrEmail}\r\n                            onChange={handleChange}\r\n                            className={`form-input ${errors.usernameOrEmail ? 'error' : ''}`}\r\n                            placeholder=\"Enter your username or email\"\r\n                        />\r\n                        {errors.usernameOrEmail && (\r\n                            <span className=\"error-message\">{errors.usernameOrEmail}</span>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                        <label htmlFor=\"password\" className=\"form-label\">\r\n                            Password\r\n                        </label>\r\n                        <input\r\n                            type=\"password\"\r\n                            id=\"password\"\r\n                            name=\"password\"\r\n                            value={formData.password}\r\n                            onChange={handleChange}\r\n                            className={`form-input ${errors.password ? 'error' : ''}`}\r\n                            placeholder=\"Enter your password\"\r\n                        />\r\n                        {errors.password && (\r\n                            <span className=\"error-message\">{errors.password}</span>\r\n                        )}\r\n                    </div>\r\n\r\n                    <button\r\n                        type=\"submit\"\r\n                        className=\"submit-btn\"\r\n                        disabled={loading}\r\n                    >\r\n                        {loading && <span className=\"loading-spinner\"></span>}\r\n                        {loading ? 'Signing In...' : 'Sign In'}\r\n                    </button>\r\n                </form>\r\n\r\n                <div className=\"form-footer\">\r\n                    Don't have an account? <Link to=\"/register\" className=\"form-link\">Sign up here</Link>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default LoginPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}